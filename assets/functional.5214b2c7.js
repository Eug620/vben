import{d as e,b as t,r as n,c as i,s,y as o,aW as r,u as c,cS as l,k as a,cT as m}from"./index.12c9c6d9.js";import{C as u}from"./CloseOutlined.37d2ceb1.js";import{L as d}from"./LeftOutlined.71b4f895.js";import{R as g}from"./RightOutlined.b9f0697b.js";const v={show:{type:Boolean,default:!1},imageList:{type:[Array],default:null},index:{type:Number,default:0}};var f,p;(p=f||(f={}))[p.LOADING=0]="LOADING",p[p.DONE=1]="DONE",p[p.FAIL=2]="FAIL";const w="img-preview";var h=e({name:"ImagePreview",props:v,setup(e){const l=t({currentUrl:"",imgScale:1,imgRotate:0,imgTop:0,imgLeft:0,status:0,currentIndex:0,moveX:0,moveY:0,show:e.show}),a=n(null),m=n(null);function v(){!function(){const e=c(a);if(!e)return;e.onmousewheel=p,document.body.addEventListener("DOMMouseScroll",p),document.ondragstart=function(){return!1}}();const{index:t,imageList:n}=e;if(!n||!n.length)throw new Error("imageList is undefined");l.currentIndex=t,x(n[t])}function f(){l.imgScale=1,l.imgRotate=0,l.imgTop=0,l.imgLeft=0}function p(e){(e=e||window.event).delta=e.wheelDelta||-e.detail,e.preventDefault(),e.delta>0&&h(.015),e.delta<0&&h(-.015)}function h(e){l.imgScale<=.2&&e<0||(l.imgScale+=e)}function L(e){l.imgRotate+=e}function _(){const e=c(m);e&&(e.onmousemove=null)}function x(e){l.status=0;const t=new Image;t.src=e,t.onload=()=>{l.currentUrl=e,l.status=1},t.onerror=()=>{l.status=2}}function I(e){e&&e.stopPropagation(),l.show=!1,document.body.removeEventListener("DOMMouseScroll",p),document.ondragstart=null}function b(){f()}function C(e){e=e||window.event,l.moveX=e.clientX,l.moveY=e.clientY;const t=c(m);t&&(t.onmousemove=y)}function y(e){(e=e||window.event).preventDefault();const t=e.clientX-l.moveX,n=e.clientY-l.moveY;l.imgLeft+=t,l.imgTop+=n,l.moveX=e.clientX,l.moveY=e.clientY}const D=i((()=>{const{imgScale:e,imgRotate:t,imgTop:n,imgLeft:i}=l;return{transform:`scale(${e}) rotate(${t}deg)`,marginTop:n+"px",marginLeft:i+"px"}})),O=i((()=>{const{imageList:t}=e;return t.length>1}));s((()=>{e.show&&v(),e.imageList&&f()}));const k=t=>c(O)?o("div",{class:["img-preview__arrow",t],onClick:()=>function(t){const{currentIndex:n}=l,{imageList:i}=e;"left"===t&&(l.currentIndex--,n<=0&&(l.currentIndex=i.length-1)),"right"===t&&(l.currentIndex++,n>=i.length-1&&(l.currentIndex=0)),x(i[l.currentIndex])}(t)},o("left"===t?d:g,null)):null;return()=>l.show&&o("div",{class:w,ref:a,onMouseup:_},o("div",{class:"img-preview-content"},o("img",{width:"32",src:r,class:["img-preview-image",0===l.status?"":"hidden"]}),o("img",{style:c(D),class:["img-preview-image",1===l.status?"":"hidden"],ref:m,src:l.currentUrl,onMousedown:C}),o("div",{class:"img-preview__close",onClick:I},o(u,{class:"img-preview__close-icon"})),(()=>{if(!c(O))return null;const{currentIndex:t}=l,{imageList:n}=e;return o("div",{class:"img-preview__index"},t+1," / ",n.length)})(),o("div",{class:"img-preview__controller"},o("div",{class:"img-preview__controller-item",onClick:()=>h(-.15)},o("img",{src:"/assets/unscale.f7e9d1be.svg"})),o("div",{class:"img-preview__controller-item",onClick:()=>h(.15)},o("img",{src:"/assets/scale.91b70fcc.svg"})),o("div",{class:"img-preview__controller-item",onClick:b},o("img",{src:"/assets/resume.c7b4bfee.svg"})),o("div",{class:"img-preview__controller-item",onClick:()=>L(-90)},o("img",{src:"/assets/unrotate.eed49fe0.svg"})),o("div",{class:"img-preview__controller-item",onClick:()=>L(90)},o("img",{src:"/assets/p-rotate.d7e7db98.svg"}))),k("left"),k("right")))}});let L=null;function _(e){if(!l)return;const{imageList:t,show:n=!0,index:i=0}=e,s={},o=document.createElement("div");s.imageList=t,s.show=n,s.index=i,L=a(h,s),m(L,o),document.body.appendChild(o)}export{_ as c};
